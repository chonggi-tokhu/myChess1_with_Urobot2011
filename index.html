<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MartyBot L4</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet"
        href="https://chonggi-tokhu.github.io/SaveMartin/MartyBot/chessboardjs/css/chessboard-1.0.0.min.css">
</head>

<body>
    <p>
        MartyBot L4
    </p>
    <div class="text-center" style="width: 400px">
        <div class="row align-items-start">
            <div class="col">
                MartyBot L4
            </div>
            <div class="col">
                <!--One of three columns-->
            </div>
            <div class="col">
                <!--One of three columns-->
            </div>
            <div class="container">
                <div id="myBoard" style="width: 100%"></div>
            </div>
            <div class="col">
                <!--One of three columns-->
            </div>
            <div class="col">
                <!--One of three columns-->
            </div>
            <div class="col">
                <!--One of three columns-->
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <MartySay></MartySay>
        </div>
    </div>
    <div class="mb-3">
        <label for="wn" class="form-label">백 이름</label>
        <input type="text" class="form-control" id="wn" placeholder="이름(아이디)" value="seoha">
        <!--<label for="bn" class="form-label">흑 이름</label>
  <input type="text" class="form-control" id="bn" placeholder="name@example.com">-->
    </div>
    <div class="mb-3">
        <label for="martycolour" class="form-label">봇의 색</label>
        <select class="form-select" aria-label="봇의 색" id="martycolour">
            <option selected value="b">흑</option>
            <option value="w">백</option>
        </select>
    </div>
    <div class="mb-3">
        <button type="button" class="btn btn-primary" id="start">start</button>
    </div>
    <label>FEN:</label>
    <div id="fen"></div>
    <label>PGN:</label>
    <div id="pgn"></div>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
        integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
        integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://chonggi-tokhu.github.io/SaveMartin/MartyBot/chessboardjs/js/chessboard-1.0.0.min.js"></script>
    <script src="https://chonggi-tokhu.github.io/SaveMartin/MartyBot/chess/chess.js"></script>
    <script>
        var board;
        var game = new Chess();
        var $board = $('#myBoard');
        var $start = $('#start');
        var $fen = $('#fen');
        var $pgn = $('#pgn');
        var $wn = $('#wn');
        var $martycolour = $('#martycolour');
        var martycolour = "b";
        var start_bool = 0;

        var chassvals = [1, 4, 2, 3, 8, 5];
        //  chassvals = [p, r, n, b, q, k];

        var openingData = [
            ["rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1", "d4"],
            ["rnbqkbnr/pppppppp/8/8/3P4/8/PPP1PPPP/RNBQKBNR b KQkq d3 0 1", "d5"],
            ["rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq e3 0 1", "e5"],
            ["rnbqkbnr/pppppppp/8/8/8/5P2/PPPPP1PP/RNBQKBNR b KQkq - 0 1", "e6"],//바보 메이트
            ["rnbqkbnr/pppp1ppp/4p3/8/6P1/5P2/PPPPP2P/RNBQKBNR b KQkq g3 0 2", "Qh4#"],//바보 메이트
        ];

        function checkOpeningData(fen) {
            var opening;
            function checkOpeningData_some(element) {
                if (element[0] == fen) {
                    opening = element[1];
                    return true;
                }
            }
            if (openingData.some(checkOpeningData_some)) {
                return opening;
            }
            return false;
        }

        $martycolour.change(function () {
            martycolour = $(this).val();
        });

        $('.square-55d63').each(function (index, item) {
            $(item).attr("style", "width:12.5%;height:12.5%;");
        });

        function MartySay(say) {
            var $MartySay = $('MartySay');
            $MartySay.html(say);
        }

        MartySay('Hello? I am Marty. Would you like to play with me?');

        $start.click(function () {
            start_bool = 1;
            game.load("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1");
            board.position("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1");
            board.orientation('white');
            $fen.html("");
            $pgn.html("");
            if (martycolour == "b") {
                game.header('White', $wn.val());
                game.header('Black', 'MartyBot L4');
            } else if (martycolour == "w") {
                game.header('Black', $wn.val());
                game.header('White', 'MartyBot L4');
            }
            if (martycolour == "w") {
                board.position("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1");
                board.orientation('black');
                window.setTimeout(makeMove, 250);
            }
            updateStatus();
        });

        function onDragStart(source, piece, position, orientation) {
            if (game.game_over()) return false;
            if (piece.search(/^${martycolour}/) !== -1) return false;
        }

        function minimaxCote(depth, game, isMaximisingPlayer) {
            var newGameMoves = game.moves();
            var bestMove = -9999;
            var bestMoveFound;

            var opening = checkOpeningData(game.fen());
            if (opening != false) {
                for (var i = 0; i < newGameMoves.length; i++) {
                    if (newGameMoves[i] == opening) {
                        return opening;
                    }
                }
            }

            for (var i = 0; i < newGameMoves.length; i++) {
                var newGameMove = newGameMoves[i]
                game.move(newGameMove);
                var value = minimax(depth - 1, game, -10000, 10000, !isMaximisingPlayer);
                game.undo();
                if (value >= bestMove) {
                    bestMove = value;
                    bestMoveFound = newGameMove;
                }
            }
            return bestMoveFound;
        }

        function minimax(depth, game, alpha, beta, isMaximisingPlayer) {
            positionCount++;
            if (depth === 0) {
                if (martycolour == 'w') {
                    return simpleEvaluateBoard(game);
                } else {
                    return -simpleEvaluateBoard(game);
                }

            }

            var newGameMoves = game.moves();

            if (isMaximisingPlayer) {
                var bestMove = -9999;
                for (var i = 0; i < newGameMoves.length; i++) {
                    game.move(newGameMoves[i]);
                    bestMove = Math.max(bestMove, minimax(depth - 1, game, alpha, beta, !isMaximisingPlayer));
                    game.undo();
                    alpha = Math.max(alpha, bestMove);
                    if (beta <= alpha) {
                        return bestMove;
                    }
                }
                return bestMove;
            } else {
                var bestMove = 9999;
                for (var i = 0; i < newGameMoves.length; i++) {
                    game.move(newGameMoves[i]);
                    bestMove = Math.min(bestMove, minimax(depth - 1, game, alpha, beta, !isMaximisingPlayer));
                    game.undo();
                    beta = Math.min(beta, bestMove);
                    if (beta <= alpha) {
                        return bestMove;
                    }
                }
                return bestMove;
            }
        }


        var boardinsimplearr = function (myparam2) {
            var rtv = [];
            for (var i = 0; i < myparam2.length; i++) {
                for (var i1 = 0; i1 < myparam2[i].length; i1++) {
                    var newsq = myparam2[i][i1];
                    rtv[rtv.length] = newsq;
                }
            }
            return rtv;
        };
        var squaresandtheirIdx = (function (board) {
            rtv = [];
            board.rank.forEach(function (val, idx, arr) {
                var ranknumber = val;
                var ranknumberstring = val.toString();
                board.file.forEach(function (val1, idx1, arr1) {
                    rtv.push(ranknumberstring + val1);
                });
            });
            return rtv;
        })({ rank: [8, 7, 6, 5, 4, 3, 2, 1], file: ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h'] });
        var idxesandtheirsquares = (function (board) {
            rtv = {};
            var idxnumber = 0;
            board.rank.forEach(function (val, idx, arr) {
                var ranknumber = val;
                var ranknumberstring = val.toString();
                board.file.forEach(function (val1, idx1, arr1) {
                    rtv[ranknumberstring + val1] = idxnumber;
                    idxnumber++
                });
            });
            return rtv;
        })({ rank: [8, 7, 6, 5, 4, 3, 2, 1], file: ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h'] });

        function simpleEvaluateBoard(game) {
            var board = game.board();
            board = boardinsimplearr(board);
            var OME = (function (myparam1) {
                var rooknumber = 0;
                var pawnnumber = 0;
                myparam1.forEach(function (val, idx, arr) {
                    if (val != null && typeof val == 'object') {

                        if (val.type == 'r') {
                            rooknumber++
                        }
                        if (val.type == 'p') {
                            pawnnumber++
                        }
                    }
                });
                if (rooknumber <= 2) {
                    return 'endGame';
                } else {
                    if (pawnnumber >= 12) {
                        return 'Opening';
                    } else {
                        return 'middlegame';
                    }
                }
            })(board);
            if (Array.isArray(board)) {
                var rtv = { w: 0, b: 0 };
                board.forEach(function (val, idx, arr) {
                    if (typeof val == 'object' && val != null) {

                        if (typeof val.type == 'string' && typeof val.color == 'string') {
                            var piecetype = val.type;
                            var piececolour = val.color;
                            console.log(OME);
                            rtv[piecetype] += chessPositionData[OME].pstSelf[piececolour][piecetype][idx];
                        }
                    }
                });
                return rtv;
            } else { return false }
        }

        var weights = { p: 100, n: 280, b: 320, r: 479, q: 929, k: 60000, k_e: 60000 };
        var chessPositionData = {
            middlegame: {
                pst_w: {/*
                    p: [
                        [100, 100, 100, 100, 105, 100, 100, 100],
                        [78, 83, 86, 73, 102, 82, 85, 90],
                        [7, 29, 21, 44, 40, 31, 44, 7],
                        [-17, 16, -2, 15, 14, 0, 15, -13],
                        [-26, 3, 10, 9, 6, -40, 0, -23],
                        [-22, 9, 5, -11, -10, -2, 3, -19],
                        [-31, 8, -7, -37, -36, -14, 3, -31],
                        [0, 0, 0, 0, 0, 0, 0, 0],
                    ],
                    n: [
                        [-66, -53, -75, -75, -10, -55, -58, -70],
                        [-3, -6, 100, -36, 4, 62, -4, -14],
                        [10, 67, 1, 74, 73, 27, 62, -2],
                        [24, 24, 45, 37, 33, 41, 25, 17],
                        [-1, 5, 31, 21, 22, 35, 2, 0],
                        [-18, 10, 13, 22, 18, 15, 11, -14],
                        [-23, -15, 2, 0, 2, 0, -23, -20],
                        [-74, -23, -26, -24, -19, -35, -22, -69],
                    ],
                    b: [
                        [-59, -78, -82, -76, -23, -107, -37, -50],
                        [-11, 20, 35, -42, -39, 31, 2, -22],
                        [-9, 39, -32, 41, 52, -10, 28, -14],
                        [25, 17, 20, 34, 26, 25, 15, 10],
                        [13, 10, 17, 23, 17, 16, 0, 7],
                        [14, 25, 24, 15, 8, 25, 20, 15],
                        [19, 20, 11, 6, 7, 6, 20, 16],
                        [-7, 2, -15, -12, -14, -15, -10, -10],
                    ],
                    r: [
                        [35, 29, 33, 4, 37, 33, 56, 50],
                        [55, 29, 56, 67, 55, 62, 34, 60],
                        [19, 35, 28, 33, 45, 27, 25, 15],
                        [0, 5, 16, 13, 18, -4, -9, -6],
                        [-28, -35, -16, -21, -13, -29, -46, -30],
                        [-42, -28, -42, -25, -25, -35, -26, -46],
                        [-53, -38, -31, -26, -29, -43, -44, -53],
                        [-30, -24, -18, 5, -2, -18, -31, -32],
                    ],
                    q: [
                        [6, 1, -8, -104, 69, 24, 88, 26],
                        [14, 32, 60, -10, 20, 76, 57, 24],
                        [-2, 43, 32, 60, 72, 63, 43, 2],
                        [1, -16, 22, 17, 25, 20, -13, -6],
                        [-14, -15, -2, -5, -1, -10, -20, -22],
                        [-30, -6, -13, -11, -16, -11, -16, -27],
                        [-36, -18, 0, -19, -15, -15, -21, -38],
                        [-39, -30, -31, -13, -31, -36, -34, -42],
                    ],
                    k: [
                        [4, 54, 47, -99, -99, 60, 83, -62],
                        [-32, 10, 55, 56, 56, 55, 10, 3],
                        [-62, 12, -57, 44, -67, 28, 37, -31],
                        [-55, 50, 11, -4, -19, 13, 0, -49],
                        [-55, -43, -52, -28, -51, -47, -8, -50],
                        [-47, -42, -43, -79, -64, -32, -29, -32],
                        [-4, 3, -14, -50, -57, -18, 13, 4],
                        [17, 30, -3, -14, 6, -1, 40, 18],
                    ],

                    // Endgame King Table
                    k_e: [
                        [-50, -40, -30, -20, -20, -30, -40, -50],
                        [-30, -20, -10, 0, 0, -10, -20, -30],
                        [-30, -10, 20, 30, 30, 20, -10, -30],
                        [-30, -10, 30, 40, 40, 30, -10, -30],
                        [-30, -10, 30, 40, 40, 30, -10, -30],
                        [-30, -10, 20, 30, 30, 20, -10, -30],
                        [-30, -30, 0, 0, 0, 0, -30, -30],
                        [-50, -30, -30, -30, -30, -30, -30, -50],
                    ],*/
                    r: [
                        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
                        [0.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [0.0, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0]
                    ],
                    q: [
                        [-2.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -2.0],
                        [-1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0],
                        [-1.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, -1.0],
                        [-0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, -0.5],
                        [0.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, -0.5],
                        [-1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, -1.0],
                        [-1.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, -1.0],
                        [-2.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -2.0]
                    ],
                    k: [

                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-2.0, -3.0, -3.0, -4.0, -4.0, -3.0, -3.0, -2.0],
                        [-1.0, -2.0, -2.0, -2.0, -2.0, -2.0, -2.0, -1.0],
                        [2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0],
                        [2.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 2.0]
                    ],
                    b: [
                        [-2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0],
                        [-1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0],
                        [-1.0, 0.0, 0.5, 1.0, 1.0, 0.5, 0.0, -1.0],
                        [-1.0, 0.5, 0.5, 1.0, 1.0, 0.5, 0.5, -1.0],
                        [-1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, -1.0],
                        [-1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0],
                        [-1.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, -1.0],
                        [-2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0]
                    ],
                    n: [
                        [-5.0, -4.0, -3.0, -3.0, -3.0, -3.0, -4.0, -5.0],
                        [-4.0, -2.0, 0.0, 0.0, 0.0, 0.0, -2.0, -4.0],
                        [-3.0, 0.0, 1.0, 1.5, 1.5, 1.0, 0.0, -3.0],
                        [-3.0, 0.5, 1.5, 2.0, 2.0, 1.5, 0.5, -3.0],
                        [-3.0, 0.0, 1.5, 2.0, 2.0, 1.5, 0.0, -3.0],
                        [-3.0, 0.5, 1.0, 1.5, 1.5, 1.0, 0.5, -3.0],
                        [-4.0, -2.0, 0.0, 0.5, 0.5, 0.0, -2.0, -4.0],
                        [-5.0, -4.0, -3.0, -3.0, -3.0, -3.0, -4.0, -5.0]
                    ],
                    p: [
                        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
                        [5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0],
                        [1.0, 1.0, 2.0, 3.0, 3.0, 2.0, 1.0, 1.0],
                        [0.5, 0.5, 1.0, 2.5, 2.5, 1.0, 0.5, 0.5],
                        [0.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0],
                        [0.5, -0.5, -1.0, 0.0, 0.0, -1.0, -0.5, 0.5],
                        [0.5, 1.0, 1.0, -2.0, -2.0, 1.0, 1.0, 0.5],
                        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
                    ]
                },
                pst_b: {},
                pstOpponent: {},
                pstSelf: {},
                coveredSquares: {

                    p: [
                        [100, 100, 100, 100, 105, 100, 100, 100],
                        [78, 83, 86, 73, 102, 82, 85, 90],
                        [7, 29, 21, 44, 40, 31, 44, 7],
                        [-17, 16, -2, 15, 14, 0, 15, -13],
                        [-26, 3, 10, 9, 6, 1, 0, -23],
                        [-22, 9, 5, -11, -10, -2, 3, -19],
                        [-31, 8, -7, -37, -36, -14, 3, -31],
                        [0, 0, 0, 0, 0, 0, 0, 0],
                    ],
                    n: [
                        [-66, -53, -75, -75, -10, -55, -58, -70],
                        [-3, -6, 100, -36, 4, 62, -4, -14],
                        [10, 67, 1, 74, 73, 27, 62, -2],
                        [24, 24, 45, 37, 33, 41, 25, 17],
                        [-1, 5, 31, 21, 22, 35, 2, 0],
                        [-18, 10, 13, 22, 18, 15, 11, -14],
                        [-23, -15, 2, 0, 2, 0, -23, -20],
                        [-74, -23, -26, -24, -19, -35, -22, -69],
                    ],
                    b: [
                        [-59, -78, -82, -76, -23, -107, -37, -50],
                        [-11, 20, 35, -42, -39, 31, 2, -22],
                        [-9, 39, -32, 41, 52, -10, 28, -14],
                        [25, 17, 20, 34, 26, 25, 15, 10],
                        [13, 10, 17, 23, 17, 16, 0, 7],
                        [14, 25, 24, 15, 8, 25, 20, 15],
                        [19, 20, 11, 6, 7, 6, 20, 16],
                        [-7, 2, -15, -12, -14, -15, -10, -10],
                    ],
                    r: [
                        [35, 29, 33, 4, 37, 33, 56, 50],
                        [55, 29, 56, 67, 55, 62, 34, 60],
                        [19, 35, 28, 33, 45, 27, 25, 15],
                        [0, 5, 16, 13, 18, -4, -9, -6],
                        [-28, -35, -16, -21, -13, -29, -46, -30],
                        [-42, -28, -42, -25, -25, -35, -26, -46],
                        [-53, -38, -31, -26, -29, -43, -44, -53],
                        [-30, -24, -18, 5, -2, -18, -31, -32],
                    ],
                    q: [
                        [6, 1, -8, -104, 69, 24, 88, 26],
                        [14, 32, 60, -10, 20, 76, 57, 24],
                        [-2, 43, 32, 60, 72, 63, 43, 2],
                        [1, -16, 22, 17, 25, 20, -13, -6],
                        [-14, -15, -2, -5, -1, -10, -20, -22],
                        [-30, -6, -13, -11, -16, -11, -16, -27],
                        [-36, -18, 0, -19, -15, -15, -21, -38],
                        [-39, -30, -31, -13, -31, -36, -34, -42],
                    ],
                    k: [
                        [4, 54, 47, -99, -99, 60, 83, -62],
                        [-32, 10, 55, 56, 56, 55, 10, 3],
                        [-62, 12, -57, 44, -67, 28, 37, -31],
                        [-55, 50, 11, -4, -19, 13, 0, -49],
                        [-55, -43, -52, -28, -51, -47, -8, -50],
                        [-47, -42, -43, -79, -64, -32, -29, -32],
                        [-4, 3, -14, -50, -57, -18, 13, 4],
                        [17, 30, -3, -14, 6, -1, 40, 18],
                    ],

                    // Endgame King Table
                    k_e: [
                        [-50, -40, -30, -20, -20, -30, -40, -50],
                        [-30, -20, -10, 0, 0, -10, -20, -30],
                        [-30, -10, 20, 30, 30, 20, -10, -30],
                        [-30, -10, 30, 40, 40, 30, -10, -30],
                        [-30, -10, 30, 40, 40, 30, -10, -30],
                        [-30, -10, 20, 30, 30, 20, -10, -30],
                        [-30, -30, 0, 0, 0, 0, -30, -30],
                        [-50, -30, -30, -30, -30, -30, -30, -50],
                    ],
                }
            },
            Opening: {
                coveredSquares: {
                    pst_w: {
                        p: [
                            [100, 100, 100, 100, 105, 100, 100, 100],
                            [78, 83, 86, 73, 102, 82, 85, 90],
                            [7, 29, 21, 44, 40, 31, 44, 7],
                            [-17, 16, 10, 24, 24, 1, 15, -13],
                            [-26, 3, 10, 9, 6, 1, 0, -23],
                            [-22, 9, 5, -11, -10, -2, 3, -19],
                            [-31, 8, -7, -37, -36, -14, 3, -31],
                            [0, 0, 0, 0, 0, 0, 0, 0],
                        ],/* ㅋㅋㅋㅋ 중앙컨트롤은 중요하니까... 폰으로 */
                        n: [
                            [-66, -53, -75, -75, -10, -55, -58, -70],
                            [-3, -6, 100, -36, 4, 62, -4, -14],
                            [10, 67, 1, 74, 73, 27, 62, -2],
                            [24, 24, 45, 37, 43, 41, 25, 17],
                            [-1, 5, 31, 41, 22, 35, 2, 0],
                            [-18, 10, 13, 22, 18, 15, 11, -14],
                            [-23, -15, 2, 0, 2, 0, -23, -20],
                            [-74, -23, -26, -24, -19, -35, -22, -69],
                        ],
                        b: [
                            [-59, -78, -82, -76, -23, -107, -37, -50],
                            [-11, 20, 35, -42, -39, 31, 2, -22],
                            [-9, 39, -32, 41, 52, -10, 28, -14],
                            [25, 17, 20, 34, 26, 25, 15, 10],
                            [13, 10, 17, 23, 17, 16, 0, 7],
                            [14, 25, 24, 15, 8, 25, 20, 15],
                            [19, 20, 11, 6, 7, 6, 20, 16],
                            [-7, 2, -15, -12, -14, -15, -10, -10],
                        ],
                        r: [
                            [35, 29, 33, 4, 37, 33, 56, 50],
                            [55, 29, 56, 67, 55, 62, 34, 60],
                            [19, 35, 28, 33, 45, 27, 25, 15],
                            [0, 5, 16, 13, 18, -4, -9, -6],
                            [-28, -35, -16, -21, -13, -29, -46, -30],
                            [-42, -28, -42, -25, -25, -35, -26, -46],
                            [-53, -38, -31, -26, -29, -43, -44, -53],
                            [-30, -24, -18, 5, -2, -18, -31, -32],
                        ],
                        q: [
                            [6, 1, -8, -104, 69, 24, 88, 26],
                            [14, 32, 60, -10, 20, 76, 57, 24],
                            [-2, 43, 32, 60, 72, 63, 43, 2],
                            [1, -16, 22, 17, 25, 20, -13, -6],
                            [-14, -15, -2, -5, -1, -10, -20, -22],
                            [-30, -6, -13, -11, -16, -11, -16, -27],
                            [-36, -18, 0, -19, -15, -15, -21, -38],
                            [-39, -30, -31, -13, -31, -36, -34, -42],
                        ],
                        k: [
                            [4, 54, 47, -99, -99, 60, 83, -62],
                            [-32, 10, 55, 56, 56, 55, 10, 3],
                            [-62, 12, -57, 44, -67, 28, 37, -31],
                            [-55, 50, 11, -4, -19, 13, 0, -49],
                            [-55, -43, -52, -28, -51, -47, -8, -50],
                            [-47, -42, -43, -79, -64, -32, -29, -32],
                            [-4, 3, -14, -50, -57, -18, 13, 4],
                            [17, 30, -3, -14, 6, -1, 40, 18],
                        ],

                        // Endgame King Table
                        k_e: [
                            [-50, -40, -30, -20, -20, -30, -40, -50],
                            [-30, -20, -10, 0, 0, -10, -20, -30],
                            [-30, -10, 20, 30, 30, 20, -10, -30],
                            [-30, -10, 30, 40, 40, 30, -10, -30],
                            [-30, -10, 30, 40, 40, 30, -10, -30],
                            [-30, -10, 20, 30, 30, 20, -10, -30],
                            [-30, -30, 0, 0, 0, 0, -30, -30],
                            [-50, -30, -30, -30, -30, -30, -30, -50],
                        ],
                    },
                    pst_b: {},
                    pstOpponent: {},
                    pstSelf: {},
                },
                pst_w: {
                    /*p: [
                        [10, 10, 10, 10, 10, 10, 10, 10],
                        [80, 95, 80, 85, 80, 85, 80, 85],
                        [65, 70, 70, 60, 60, 60, 60, 60],
                        [-17, 16, -2, 15, 14, 0, 15, -13],
                        [-26, 3, 10, 39, 46, -80, 0, -23],
                        [-22, 9, 5, -11, -10, -2, 3, -19],
                        [-31, 8, -7, -37, -36, -14, 3, -31],
                        [0, 0, 0, 0, 0, 0, 0, 0],
                    ],
                    n: [
                        [-66, -53, -75, -75, -10, -55, -58, -70],
                        [-3, -6, 100, -36, 4, 62, -4, -14],
                        [10, 67, 1, 74, 73, 27, 62, -2],
                        [24, 24, 45, 37, 33, 41, 25, 17],
                        [-1, 5, 31, 21, 22, 35, 2, 0],
                        [-18, 10, 13, 22, 18, 15, 11, -14],
                        [-23, -15, 2, 0, 2, 0, -23, -20],
                        [-74, -23, -26, -24, -19, -35, -22, -69],
                    ],
                    b: [
                        [-59, -78, -82, -76, -23, -107, -37, -50],
                        [-11, 20, 35, -42, -39, 31, 2, -22],
                        [-9, 39, -32, 41, 52, -10, 28, -14],
                        [25, 27, 20, 34, 26, 25, 35, 10],
                        [13, 10, 17, 23, 17, 16, 0, 7],
                        [14, 25, 24, 15, 8, 25, 20, 15],
                        [19, 20, 11, 6, 7, 6, 20, 16],
                        [-7, 2, -15, -12, -14, -15, -10, -10],
                    ],
                    r: [
                        [35, 29, 33, 4, 37, 33, 56, 50],
                        [55, 29, 56, 67, 55, 62, 34, 60],
                        [19, 35, 28, 33, 45, 27, 25, 15],
                        [0, 5, 16, 13, 18, -4, -9, -6],
                        [-28, -35, -16, -21, -13, -29, -46, -30],
                        [-42, -28, -42, -25, -25, -35, -26, -46],
                        [-53, -38, -31, -26, -29, -43, -44, -53],
                        [-30, -24, -18, 5, -2, -18, -31, -32],
                    ],
                    q: [
                        [6, 1, -8, -104, 69, 24, 88, 26],
                        [14, 32, 60, -10, 20, 76, 57, 24],
                        [-2, 43, 32, 60, 72, 63, 43, 2],
                        [1, -16, 22, 17, 25, 20, -13, -6],
                        [-14, -15, -2, -5, -1, -10, -20, -22],
                        [-30, -6, -13, -11, -16, -11, -16, -27],
                        [-36, -18, 0, -19, -15, -15, -21, -38],
                        [-39, -30, -31, -13, -31, -36, -34, -42],
                    ],
                    k: [
                        [4, 54, 47, -99, -99, 60, 83, -62],
                        [-32, 10, 55, 56, 56, 55, 10, 3],
                        [-62, 12, -57, 44, -67, 28, 37, -31],
                        [-55, 50, 11, -4, -19, 13, 0, -49],
                        [-55, -43, -52, -28, -51, -47, -8, -50],
                        [-47, -42, -43, -79, -64, -32, -29, -32],
                        [-4, 3, -14, -50, -57, -18, 13, 4],
                        [17, 30, -3, -14, 6, -1, 40, 18],
                    ],

                    // Endgame King Table
                    k_e: [
                        [-50, -40, -30, -20, -20, -30, -40, -50],
                        [-30, -20, -10, 0, 0, -10, -20, -30],
                        [-30, -10, 20, 30, 30, 20, -10, -30],
                        [-30, -10, 30, 40, 40, 30, -10, -30],
                        [-30, -10, 30, 40, 40, 30, -10, -30],
                        [-30, -10, 20, 30, 30, 20, -10, -30],
                        [-30, -30, 0, 0, 0, 0, -30, -30],
                        [-50, -30, -30, -30, -30, -30, -30, -50],
                    ],*/

                    r: [
                        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
                        [0.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [0.0, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0]
                    ],
                    q: [
                        [-2.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -2.0],
                        [-1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0],
                        [-1.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, -1.0],
                        [-0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, -0.5],
                        [0.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, -0.5],
                        [-1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, -1.0],
                        [-1.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, -1.0],
                        [-2.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -2.0]
                    ],
                    k: [

                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-2.0, -3.0, -3.0, -4.0, -4.0, -3.0, -3.0, -2.0],
                        [-1.0, -2.0, -2.0, -2.0, -2.0, -2.0, -2.0, -1.0],
                        [2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0],
                        [2.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 2.0]
                    ],
                    b: [
                        [-2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0],
                        [-1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0],
                        [-1.0, 0.0, 0.5, 1.0, 1.0, 0.5, 0.0, -1.0],
                        [-1.0, 0.5, 0.5, 1.0, 1.0, 0.5, 0.5, -1.0],
                        [-1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, -1.0],
                        [-1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0],
                        [-1.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, -1.0],
                        [-2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0]
                    ],
                    n: [
                        [-5.0, -4.0, -3.0, -3.0, -3.0, -3.0, -4.0, -5.0],
                        [-4.0, -2.0, 0.0, 0.0, 0.0, 0.0, -2.0, -4.0],
                        [-3.0, 0.0, 1.0, 1.5, 1.5, 1.0, 0.0, -3.0],
                        [-3.0, 0.5, 1.5, 2.0, 2.0, 1.5, 0.5, -3.0],
                        [-3.0, 0.0, 1.5, 2.0, 2.0, 1.5, 0.0, -3.0],
                        [-3.0, 0.5, 1.0, 1.5, 1.5, 1.0, 0.5, -3.0],
                        [-4.0, -2.0, 0.0, 0.5, 0.5, 0.0, -2.0, -4.0],
                        [-5.0, -4.0, -3.0, -3.0, -3.0, -3.0, -4.0, -5.0]
                    ],
                    p: [
                        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
                        [5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0],
                        [1.0, 1.0, 2.0, 3.0, 3.0, 2.0, 1.0, 1.0],
                        [0.5, 0.5, 1.0, 2.5, 2.5, 1.0, 0.5, 0.5],
                        [0.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0],
                        [0.5, -0.5, -1.0, 0.0, 0.0, -1.0, -0.5, 0.5],
                        [0.5, 1.0, 1.0, -2.0, -2.0, 1.0, 1.0, 0.5],
                        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
                    ]
                },
                pst_b: {},
                pstOpponent: {},
                pstSelf: {},
            },
            endGame: {
                coveredSquares: {
                    pst_w: {
                        p: [
                            [100, 100, 100, 100, 100, 100, 100, 100],
                            [50, 65, 50, 55, 50, 55, 50, 55],
                            [35, 40, 40, 30, 30, 40, 30, 30],
                            [20, 20, 20, 40, 40, 20, 20, 20],
                            [10, 10, 10, 40, 40, 40, 10, 10],
                            [10, 10, 10, 10, 10, 10, 10, 10],
                            [10, 10, 10, 10, 10, 10, 10, 10],
                            [10, 10, 10, 10, 10, 10, 10, 10],
                            [0, 0, 0, 0, 0, 0, 0, 0],
                        ],
                        b: [
                            [-10, -10, -10, -10, -10, 20, 20, 20],
                            [-5, 0, 5, 10, 10, 55, 0, -5],
                            [20, 50, 50, 50, 50, 50, 20, 20],
                            [-10, 30, 40, 50, 50, 10, 0, 20],
                            [-10, 30, 40, 50, 50, 10, 0, 20],
                            [-10, 20, 20, 20, 20, 10, -10, 20],
                            [0, 30, 30, 30, 30, 30, 0, 30],
                            [-20, -20, -20, -20, 10, 10, -20, -20],
                        ],
                        n: [
                            [10, 10, 10, 10, 10, 10, 10, 10],
                            [10, 10, 10, 10, 10, 10, 10, 10],
                            [10, 10, 10, 10, 10, 10, 10, 10],
                            [10, 10, 10, 20, 20, 10, 10, 10],
                            [10, 10, 10, 20, 20, 10, 10, 10],
                            [10, 10, 10, 10, 10, 10, 10, 10],
                            [10, 10, 10, 10, 10, 10, 10, 10],
                            [10, 10, 10, 10, 10, 10, 10, 10],
                        ],
                        q: [
                            [20, 10, 0, -10, -10, 0, 10, 20],
                            [10, 5, 0, -5, -5, 0, 5, 10],
                            [5, 0, -5, -10, -10, -5, 0, 5],
                            [-10, -10, -10, 30, 30, -10, -10, -10],
                            [-10, -10, -10, 30, 30, -10, -10, -10],
                            [5, 0, 5, -10, -10, -5, 0, 5],
                            [10, 5, 0, -5, -5, 0, 5, 10],
                            [20, 10, 0, -10, -10, 0, 10, 20],
                        ],
                        k: [
                            [0, 0, 0, 0, 0, 0, 0, 0],
                            [0, 0, 0, 0, 0, 0, 0, 0],
                            [0, 0, 0, 0, 0, 0, 0, 0],
                            [0, 0, 0, 0, 0, 0, 0, 0],
                            [0, 0, 0, 0, 0, 0, 0, 0],
                            [0, 0, 0, 0, 0, 0, 0, 0],
                            [0, 0, 0, 0, 0, 0, 0, 0],
                            [0, 0, 0, 0, 0, 0, 0, 0],
                        ],
                        r: [
                            [-10, -10, -10, -10, 5, -10, -10, -10],
                            [45, 45, 45, 45, 60, 45, 45, 45],
                            [30, 30, 30, 30, 75, 30, 30, 30],
                            [-20, -20, -20, -20, -5, -20, -20, -20],
                            [0, 0, 0, 0, 15, 0, 0, 0],
                            [30, 30, 30, 30, 45, 30, 30, 30],
                            [-20, -20, -20, -20, -5, -20, -20, -20],
                            [-10, -10, -10, -10, 5, -10, -10, -10],
                        ],
                    },
                    pst_b: {},
                    pstOpponent: {},
                    pstSelf: {},
                },
                pst_w: {
                    /*p: [
                        [100, 100, 100, 100, 100, 100],
                        [80, 80, 80, 80, 80, 80],
                        [20, 20, 20, 20, 20, 20],
                        [10, 10, 10, 10, 10, 10],
                        [10, 10, 10, 10, 10, 10],
                        [20, 20, 20, 20, 20, 20],
                        [10, 10, 10, 10, 10, 10],
                        [0, 0, 0, 0, 0, 0],
                    ],
                    n: [
                        [-66, -53, -75, -75, -10, -55, -58, -70],
                        [-3, -6, 100, -36, 4, 62, -4, -14],
                        [10, 67, 1, 74, 73, 27, 62, -2],
                        [24, 24, 45, 37, 33, 41, 25, 17],
                        [-1, 5, 31, 21, 22, 35, 2, 0],
                        [-18, 10, 13, 22, 18, 15, 11, -14],
                        [-23, -15, 2, 0, 2, 0, -23, -20],
                        [-74, -23, -26, -24, -19, -35, -22, -69],
                    ],
                    b: [
                        [-59, -78, -82, -76, -23, -107, -37, -50],
                        [-11, 20, 35, -42, -39, 31, 2, -22],
                        [-9, 39, -32, 41, 52, -10, 28, -14],
                        [25, 17, 20, 34, 26, 25, 15, 10],
                        [13, 10, 17, 23, 17, 16, 0, 7],
                        [14, 25, 24, 15, 8, 25, 20, 15],
                        [19, 20, 11, 6, 7, 6, 20, 16],
                        [-7, 2, -15, -12, -14, -15, -10, -10],
                    ],
                    r: [
                        [35, 29, 33, 4, 37, 33, 56, 50],
                        [55, 29, 56, 67, 55, 62, 34, 60],
                        [19, 35, 28, 33, 45, 27, 25, 15],
                        [0, 5, 16, 13, 18, -4, -9, -6],
                        [-28, -35, -16, -21, -13, -29, -46, -30],
                        [-42, -28, -42, -25, -25, -35, -26, -46],
                        [-53, -38, -31, -26, -29, -43, -44, -53],
                        [-30, -24, -18, 5, -2, -18, -31, -32],
                    ],
                    q: [
                        [6, 1, -8, -104, 69, 24, 88, 26],
                        [14, 32, 60, -10, 20, 76, 57, 24],
                        [-2, 43, 32, 60, 72, 63, 43, 2],
                        [1, -16, 22, 17, 25, 20, -13, -6],
                        [-14, -15, -2, -5, -1, -10, -20, -22],
                        [-30, -6, -13, -11, -16, -11, -16, -27],
                        [-36, -18, 0, -19, -15, -15, -21, -38],
                        [-39, -30, -31, -13, -31, -36, -34, -42],
                    ],
                    k: [
                        [4, 54, 47, -99, -99, 60, 83, -62],
                        [-32, 10, 55, 56, 56, 55, 10, 3],
                        [-62, 12, -57, 44, -67, 28, 37, -31],
                        [-55, 50, 11, -4, -19, 13, 0, -49],
                        [-55, -43, -52, -28, -51, -47, -8, -50],
                        [-47, -42, -43, -79, -64, -32, -29, -32],
                        [-4, 3, -14, -50, -57, -18, 13, 4],
                        [17, 30, -3, -14, 6, -1, 40, 18],
                    ],

                    // Endgame King Table
                    k_e: [
                        [-50, -40, -30, -20, -20, -30, -40, -50],
                        [-30, -20, -10, 0, 0, -10, -20, -30],
                        [-30, -10, 20, 30, 30, 20, -10, -30],
                        [-30, -10, 30, 40, 40, 30, -10, -30],
                        [-30, -10, 30, 40, 40, 30, -10, -30],
                        [-30, -10, 20, 30, 30, 20, -10, -30],
                        [-30, -30, 0, 0, 0, 0, -30, -30],
                        [-50, -30, -30, -30, -30, -30, -30, -50],
                    ],*/

                    r: [
                        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
                        [0.5, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [-0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5],
                        [0.0, 0.0, 0.0, 0.5, 0.5, 0.0, 0.0, 0.0]
                    ],
                    q: [
                        [-2.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -2.0],
                        [-1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0],
                        [-1.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, -1.0],
                        [-0.5, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, -0.5],
                        [0.0, 0.0, 0.5, 0.5, 0.5, 0.5, 0.0, -0.5],
                        [-1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.0, -1.0],
                        [-1.0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, -1.0],
                        [-2.0, -1.0, -1.0, -0.5, -0.5, -1.0, -1.0, -2.0]
                    ],
                    k: [

                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-3.0, -4.0, -4.0, -5.0, -5.0, -4.0, -4.0, -3.0],
                        [-2.0, -3.0, -3.0, -4.0, -4.0, -3.0, -3.0, -2.0],
                        [-1.0, -2.0, -2.0, -2.0, -2.0, -2.0, -2.0, -1.0],
                        [2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 2.0, 2.0],
                        [2.0, 3.0, 1.0, 0.0, 0.0, 1.0, 3.0, 2.0]
                    ],
                    b: [
                        [-2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0],
                        [-1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0],
                        [-1.0, 0.0, 0.5, 1.0, 1.0, 0.5, 0.0, -1.0],
                        [-1.0, 0.5, 0.5, 1.0, 1.0, 0.5, 0.5, -1.0],
                        [-1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, -1.0],
                        [-1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, -1.0],
                        [-1.0, 0.5, 0.0, 0.0, 0.0, 0.0, 0.5, -1.0],
                        [-2.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -2.0]
                    ],
                    n: [
                        [-5.0, -4.0, -3.0, -3.0, -3.0, -3.0, -4.0, -5.0],
                        [-4.0, -2.0, 0.0, 0.0, 0.0, 0.0, -2.0, -4.0],
                        [-3.0, 0.0, 1.0, 1.5, 1.5, 1.0, 0.0, -3.0],
                        [-3.0, 0.5, 1.5, 2.0, 2.0, 1.5, 0.5, -3.0],
                        [-3.0, 0.0, 1.5, 2.0, 2.0, 1.5, 0.0, -3.0],
                        [-3.0, 0.5, 1.0, 1.5, 1.5, 1.0, 0.5, -3.0],
                        [-4.0, -2.0, 0.0, 0.5, 0.5, 0.0, -2.0, -4.0],
                        [-5.0, -4.0, -3.0, -3.0, -3.0, -3.0, -4.0, -5.0]
                    ],
                    p: [
                        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
                        [5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0, 5.0],
                        [1.0, 1.0, 2.0, 3.0, 3.0, 2.0, 1.0, 1.0],
                        [0.5, 0.5, 1.0, 2.5, 2.5, 1.0, 0.5, 0.5],
                        [0.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0],
                        [0.5, -0.5, -1.0, 0.0, 0.0, -1.0, -0.5, 0.5],
                        [0.5, 1.0, 1.0, -2.0, -2.0, 1.0, 1.0, 0.5],
                        [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
                    ]
                },
                pst_b: {},
                pstOpponent: {},
                pstSelf: {},
            },
        };
        var pst_w = {
            p: [
                [100, 100, 100, 100, 105, 100, 100, 100],
                [78, 83, 86, 73, 102, 82, 85, 90],
                [7, 29, 21, 44, 40, 31, 44, 7],
                [-17, 16, -2, 15, 14, 0, 15, -13],
                [-26, 3, 10, 9, 6, 1, 0, -23],
                [-22, 9, 5, -11, -10, -2, 3, -19],
                [-31, 8, -7, -37, -36, -14, 3, -31],
                [0, 0, 0, 0, 0, 0, 0, 0],
            ],
            n: [
                [-66, -53, -75, -75, -10, -55, -58, -70],
                [-3, -6, 100, -36, 4, 62, -4, -14],
                [10, 67, 1, 74, 73, 27, 62, -2],
                [24, 24, 45, 37, 33, 41, 25, 17],
                [-1, 5, 31, 21, 22, 35, 2, 0],
                [-18, 10, 13, 22, 18, 15, 11, -14],
                [-23, -15, 2, 0, 2, 0, -23, -20],
                [-74, -23, -26, -24, -19, -35, -22, -69],
            ],
            b: [
                [-59, -78, -82, -76, -23, -107, -37, -50],
                [-11, 20, 35, -42, -39, 31, 2, -22],
                [-9, 39, -32, 41, 52, -10, 28, -14],
                [25, 17, 20, 34, 26, 25, 15, 10],
                [13, 10, 17, 23, 17, 16, 0, 7],
                [14, 25, 24, 15, 8, 25, 20, 15],
                [19, 20, 11, 6, 7, 6, 20, 16],
                [-7, 2, -15, -12, -14, -15, -10, -10],
            ],
            r: [
                [35, 29, 33, 4, 37, 33, 56, 50],
                [55, 29, 56, 67, 55, 62, 34, 60],
                [19, 35, 28, 33, 45, 27, 25, 15],
                [0, 5, 16, 13, 18, -4, -9, -6],
                [-28, -35, -16, -21, -13, -29, -46, -30],
                [-42, -28, -42, -25, -25, -35, -26, -46],
                [-53, -38, -31, -26, -29, -43, -44, -53],
                [-30, -24, -18, 5, -2, -18, -31, -32],
            ],
            q: [
                [6, 1, -8, -104, 69, 24, 88, 26],
                [14, 32, 60, -10, 20, 76, 57, 24],
                [-2, 43, 32, 60, 72, 63, 43, 2],
                [1, -16, 22, 17, 25, 20, -13, -6],
                [-14, -15, -2, -5, -1, -10, -20, -22],
                [-30, -6, -13, -11, -16, -11, -16, -27],
                [-36, -18, 0, -19, -15, -15, -21, -38],
                [-39, -30, -31, -13, -31, -36, -34, -42],
            ],
            k: [
                [4, 54, 47, -99, -99, 60, 83, -62],
                [-32, 10, 55, 56, 56, 55, 10, 3],
                [-62, 12, -57, 44, -67, 28, 37, -31],
                [-55, 50, 11, -4, -19, 13, 0, -49],
                [-55, -43, -52, -28, -51, -47, -8, -50],
                [-47, -42, -43, -79, -64, -32, -29, -32],
                [-4, 3, -14, -50, -57, -18, 13, 4],
                [17, 30, -3, -14, 6, -1, 40, 18],
            ],

            // Endgame King Table
            k_e: [
                [-50, -40, -30, -20, -20, -30, -40, -50],
                [-30, -20, -10, 0, 0, -10, -20, -30],
                [-30, -10, 20, 30, 30, 20, -10, -30],
                [-30, -10, 30, 40, 40, 30, -10, -30],
                [-30, -10, 30, 40, 40, 30, -10, -30],
                [-30, -10, 20, 30, 30, 20, -10, -30],
                [-30, -30, 0, 0, 0, 0, -30, -30],
                [-50, -30, -30, -30, -30, -30, -30, -50],
            ],
        };
        var psts = {
            opening: chessPositionData.Opening,
            middlegame: chessPositionData.middlegame,
            endGame: chessPositionData.endGame,
        }
        var pst_b = {
            p: pst_w['p'].slice().reverse(),
            n: pst_w['n'].slice().reverse(),
            b: pst_w['b'].slice().reverse(),
            r: pst_w['r'].slice().reverse(),
            q: pst_w['q'].slice().reverse(),
            k: pst_w['k'].slice().reverse(),
            k_e: pst_w['k_e'].slice().reverse(),
        };

        var pstOpponent = { w: pst_b, b: pst_w };
        var pstSelf = { w: pst_w, b: pst_b };
        chessPositionData.endGame.coveredSquares.pst_b = {
            p: chessPositionData.endGame.coveredSquares.pst_w['p'].slice().reverse(),
            n: chessPositionData.endGame.coveredSquares.pst_w['n'].slice().reverse(),
            b: chessPositionData.endGame.coveredSquares.pst_w['b'].slice().reverse(),
            q: chessPositionData.endGame.coveredSquares.pst_w['q'].slice().reverse(),
            k: chessPositionData.endGame.coveredSquares.pst_w['k'].slice().reverse(),
            r: chessPositionData.endGame.coveredSquares.pst_w['r'].slice().reverse(),
        };

        chessPositionData.endGame.pst_b = {
            p: chessPositionData.endGame.pst_w['p'].slice().reverse(),
            n: chessPositionData.endGame.pst_w['n'].slice().reverse(),
            b: chessPositionData.endGame.pst_w['b'].slice().reverse(),
            q: chessPositionData.endGame.pst_w['q'].slice().reverse(),
            k: chessPositionData.endGame.pst_w['k'].slice().reverse(),
            r: chessPositionData.endGame.pst_w['r'].slice().reverse(),
        };
        chessPositionData.middlegame.pst_b = {
            p: chessPositionData.middlegame.pst_w['p'].slice().reverse(),
            n: chessPositionData.middlegame.pst_w['n'].slice().reverse(),
            b: chessPositionData.middlegame.pst_w['b'].slice().reverse(),
            q: chessPositionData.middlegame.pst_w['q'].slice().reverse(),
            k: chessPositionData.middlegame.pst_w['k'].slice().reverse(),
            r: chessPositionData.middlegame.pst_w['r'].slice().reverse(),
        }

        chessPositionData.Opening.pst_b = {
            p: chessPositionData.Opening.pst_w['p'].slice().reverse(),
            n: chessPositionData.Opening.pst_w['n'].slice().reverse(),
            b: chessPositionData.Opening.pst_w['b'].slice().reverse(),
            q: chessPositionData.Opening.pst_w['q'].slice().reverse(),
            k: chessPositionData.Opening.pst_w['k'].slice().reverse(),
            r: chessPositionData.Opening.pst_w['r'].slice().reverse(),
        }
        chessPositionData.middlegame.pstOpponent = {
            w: chessPositionData.middlegame.pst_w,
            b: chessPositionData.middlegame.pst_b,
        }
        chessPositionData.middlegame.pstSelf = {
            w: chessPositionData.middlegame.pst_w,
            b: chessPositionData.middlegame.pst_b,
        }

        chessPositionData.Opening.pstOpponent = {
            w: chessPositionData.Opening.pst_w,
            b: chessPositionData.Opening.pst_b,
        }
        chessPositionData.Opening.pstSelf = {
            w: chessPositionData.Opening.pst_w,
            b: chessPositionData.Opening.pst_b,
        }
        chessPositionData.Opening.coveredSquares.pstOpponent = {
            w: chessPositionData.Opening.coveredSquares.pst_w,
            b: chessPositionData.Opening.coveredSquares.pst_b,
        }
        chessPositionData.Opening.coveredSquares.pstSelf = {
            w: chessPositionData.Opening.coveredSquares.pst_w,
            b: chessPositionData.Opening.coveredSquares.pst_b,
        }

        chessPositionData.endGame.coveredSquares.pstOpponent = {
            w: chessPositionData.endGame.coveredSquares.pst_w,
            b: chessPositionData.endGame.coveredSquares.pst_b,
        }
        chessPositionData.endGame.coveredSquares.pstSelf = {
            w: chessPositionData.endGame.coveredSquares.pst_w,
            b: chessPositionData.endGame.coveredSquares.pst_b,
        }

        chessPositionData.endGame.pstOpponent = {
            w: chessPositionData.pst_w,
            b: chessPositionData.endGame.pst_b,
        }
        chessPositionData.endGame.pstSelf = {
            w: chessPositionData.endGame.pst_w,
            b: chessPositionData.endGame.pst_b,
        }
        function getPieceValue(piece, x, y) {
            if (piece === null) {
                return 0;
            }
            function getAbsoluteValue(piece, isWhite, x, y) {
                if (piece.type === 'p') {
                    return 10 + (isWhite ? pawnEvalWhite[y][x] : pawnEvalBlack[y][x]);
                } else if (piece.type === 'r') {
                    return 50 + (isWhite ? rookEvalWhite[y][x] : rookEvalBlack[y][x]);
                } else if (piece.type === 'n') {
                    return 30 + knightEval[y][x];
                } else if (piece.type === 'b') {
                    return 30 + (isWhite ? bishopEvalWhite[y][x] : bishopEvalBlack[y][x]);
                } else if (piece.type === 'q') {
                    return 90 + evalQueen[y][x];
                } else if (piece.type === 'k') {
                    return 900 + (isWhite ? kingEvalWhite[y][x] : kingEvalBlack[y][x]);
                }
                throw "Unknown piece type: " + piece.type;
            }
            var absoluteValue = getAbsoluteValue(piece, piece.color === 'w', x, y);
            return piece.color === 'w' ? absoluteValue : -absoluteValue;
        }

        var positionCount;
        function getBestMove(game) {
            positionCount = 0;
            var depth = parseInt(1);
            var bestMove = minimaxCote(depth, game, martycolour == 'b');
            return bestMove;
        }

        function makeMove() {
            MartySay('Hmm....');
            updateStatus();
            var possibleMoves = game.moves();

            if (possibleMoves.length === 0) return;

            var possibleMoves = game.moves();

            if (game.game_over() === true ||
                game.in_draw() === true ||
                possibleMoves.length === 0) return;
            var bestMove = getBestMove(game);
            console.log(bestMove);
            game.move(bestMove);
            board.position(game.fen());

            updateStatus();
        }


        function updateStatus() {
            if (start_bool == 0) {
                if (martycolour == "b") {
                    game.header('White', $wn.val());
                    game.header('Black', 'MartyBot L4');
                } else if (martycolour == "w") {
                    game.header('Black', $wn.val());
                    game.header('White', 'MartyBot L4');
                }
            }
            var movecolour = 'White';
            if (game.turn() === 'b') {
                movecolour = 'Black';
            }
            if (game.in_checkmate()) {
                status = 'Game over, ' + movecolour + ' is in checkmate.';
                if (martycolour == game.turn()) {
                    MartySay('Checkmate! Whoops, I lost. Would you like another round?');
                } else {
                    MartySay('Checkmate! Oops, you lost.');
                }
            } else if (game.in_draw()) {
                status = 'Game over, drawn position';
                MartySay('Oh, it`s a draw. Would you like another round?');
            } else {
                status = movecolour + ' to move';
                if (game.in_check()) {
                    status += ', ' + movecolour + ' is in check';
                    if (martycolour == game.turn()) {
                        MartySay('Hmm, I`ve been checked.');
                    } else {
                        MartySay('You`ve been checked. i like check!');
                    }
                }
            }
            $fen.html(game.fen());
            $pgn.html(game.pgn());
        }

        function onDrop(source, target) {
            var move = game.move({
                from: source,
                to: target,
                promotion: 'q'
            });

            if (move === null) return 'snapback';
            window.setTimeout(makeMove, 250);
        }


        function onSnapEnd() {
            board.position(game.fen());
        }

        function pieceTheme(piece) {
            if (piece.search(/w/) !== -1) {
                return 'https://chonggi-tokhu.github.io/SaveMartin/MartyBot/chessboardjs/img/chesspieces/wikipedia/' + piece + '.png';
            }
            return 'https://chonggi-tokhu.github.io/SaveMartin/MartyBot/chessboardjs/img/chesspieces/wikipedia/' + piece + '.png';
        }

        var config = {
            pieceTheme: pieceTheme,
            draggable: true,
            position: 'start',
            onDragStart: onDragStart,
            onDrop: onDrop,
            onSnapEnd: onSnapEnd
        };
        board = Chessboard('myBoard', config);
    </script>
</body>

</html>
